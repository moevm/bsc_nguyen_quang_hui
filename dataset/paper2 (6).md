# Разработка генератора отчетов для SCADA системы

Ключевые слова: генератор отчетов, автоматическое построение отчетов, программное решение, приложение.

## Аннотация
Целью данной статьи является разработка приложения для автоматизации построения отчетов о ходе 
технологических процессов на предприятии. В данной статье рассмотрены преимущества, которые 
дает использование программных средств для решения задачи построения отчетов. Был проведен сравнительный
анализ существующих программных решений в ходе которого были выявлены их достоинства и недостатки.
На основе сравнительного анализа были сформированы требования к разрабатываемому приложению.

## Введение
Системы автоматического построения отчетов нашли широкое применение в промышленности, финансовой и других
сферах деятельности. Автоматизация процесса построения отчетов позволяет уменьшить время, 
необходимое для построения отчетов. Сведение к минимуму ручных действий позволяет снизить 
вероятность возникновения случайной ошибки, обусловленной человеческим фактором.
Формализация процесса, являющаяся необходимым шагом на пути автоматизации построения отчетов, 
делает данные в отчете более объективными, а также усложняет возможность намеренного искажения данных.

Разработка системы для построения отчетов о ходе технологических процессов на предприятии имеет 
свои особенности, например специфичные для данной области протоколы для передачи данных. 
Для решения проблемы разработки средств автоматического построения отчетов, содержащих всю 
необходимую информацию, в условиях ограниченных ресурсов, требуется рассмотреть существующие программные 
решения, решающие аналогичные задачи. Обзор аналогов позволит выявить их достоинства и недостатки, что
поможет сформировать требования к решению данной проблемы. Целью данной работы является разработка 
требований и подхода к созданию приложения для автоматизации построения отчетов о ходе технологических процессов на предприятии.
Объектом данного исследования является автоматизация процесса построения отчетов. 
Предмет исследования - способы автоматизации построения отчетов о ходе технологических процессов
на предприятии.


## Обзор предметной области
Для формирования требований к проектируемой системе необходимо рассмотреть существующие программные решения. 
Рассматриваемые аналоги должны обладать возможностью задания макета отчета посредством графического интерфейса пользователя,
а также возможностью экспорта построенных отчетов в файл формата pdf. 
Среди множества программных решений поставленной проблемы были выбраны решения относящиеся к области построения отчетов для SCADA-систем.

**TRACE MODE** [3], [9] - Генератор отчетов TRACE MODE является составной частью системы SCADA TRACE MODE.
Редактирование шаблонов отчетов производится в визуальном редакторе, который позволяет задать форматирование документа.
Генератор отчетов TRACE MODE позволяет вставлять в отчет данные, полученные путем обращения к внешним
базам данных при помощи SQL запросов, а также данные, полученные напрямую по протоколу OPC.
TRACE MODE генерирует документы в формате HTML. 


**Abak Reporter** [4] - Генератор отчетов Abak Reporter входит в состав программно-аппаратного комплекса 
ИВК Abak+. Генератор отчетов строит отчеты по данным входящем в состав комплекса базы данных, которые могут
быть получены посредством передачи с помощью USB-накопителя, а также при помощи Ethernet.
Графический редактор позволяет настраивать оформление шаблонов отчетов. 
Сформированные отчеты могут сохраняться в форматах PDF, XLS и HTML.


**Stimulsoft Reports** [5], [8] Stimulsoft Reports - представляет собой набор компонентов 
для построения отчетов.
Генератор отчетов позволяет строить отчеты по данным из внешних реляционных баз данных, а также из файлов
формата CSV, Excel, Json, Xml.
Редактор шаблона отчета предоставляет пользователю настраивать внешний вид шаблона, а также задавать 
преобразования полученных данных.
Программа для просмотра отчетов представляет собой инструмент для просмотра, печати, экспорта отчетов.
Stimulsoft Reports поддерживает большое количество форматов файлов для сохранения 
построенных отчетов, в том числе word, excel, pdf, html.


**FastReport VCL** [1], [6] FastReport VCL включает в себя дизайнер, 
который предоставляет пользователю удобные средства для разработки внешнего вида отчета.
Дизайнер поддерживает наследование шаблонов отчетов.
Для построения отчетов FastReport VCL использует данные, полученные из внешних БД.
Для написания процедур для обработки полученных данных используются собственные 
реализации скриптовых языков C++ Script, PascalScript.
Возможен экспорт отчетов в популярные форматы такие как PDF, EXCEL, HTML, CSV, JPEG, ODF, WORD.


**Dream Report** [2], [7], [10] Dream Report представляет собой систему для построения, хранения и отображения отчетов.
Dream Report Имеет в своем составе редактор отчетов, позволяющий использовать в отчетах набор готовых 
функций по обработке данных без написания скриптов.
Dream Report позволяет получать данные по интерфейсам OPC DA, MODBUS, которые являются 
распостраненными в сфере АСУ ТП, а также посредством подключений ко внешним базам данных.
Редактор отчетов поддерживает большой набор статистических функций для обработки данных, 
а также позволяет создавать интерактивные отчеты.
DREAM REPORT позволяет экспортировать готовые отчеты в форматы EXCEL, PDF, HTML.


Для сравнения аналогов были выбраны следующие критерии: "Системные требования", 
"Возможность экспорта отчета в форматы популярных табличных процессоров",
"Поддержка чтения данных посредством промышленных протоколов OPC и Modbus",
"Возможность просмотра отчетов через Web-интерфейс"

Далее приведено описание каждого из критериев.

**1. Системные требования** Под системными требованиями подразумеваютcя рекомендуемые производителем 
требования к аппаратному обеспечению, а также требования к установленной операционной системе.
С повышением системных требований сокращается перечень устройств, на которых возможно использование
данного ПО. 

**2. Возможность экспорта отчета в форматы популярных табличных процессоров** Под форматами 
популярных табличных процессоров в данной работе подразумеваются файлы в форматах 
Microsoft Excel, LibreOffice Calc, ODF. 
Возможность экспорта отчета в форматы популярных табличных процессоров позволяет 
при необходимости корректировать отчеты вручную.

**3. Поддержка чтения данных посредством промышленных протоколов OPC и Modbus** В промышленности 
для передачи показаний датчиков часто используются протоколы OPC и MODBUS для передачи данных. 
Возможность чтения данных по этим протоколам позволяет 
строить отчеты без использования дополнительного программного обеспечения.

**4. Возможность просмотра отчетов через Web-интерфейс** Возможность просмотра отчетов через 
Web-интерфейс позволяет просматривать отчеты на широком спектре устройств 
включая мобильные устройства, 
а также не требует для просмотра отчетов наличия и настройки какого-либо дополнительного ПО, 
за исключением Web-браузера. 


Результаты сравнения рассмотренных программных средств по перечисленным критериям приведены в таблице 1.


Таблица 1 - Сравнение аналогов

|                                                                         | TRACE MODE | Abak Reporter  | Stimulsoft Reports  | FastReport VCL | Dream Report   |
| ----------------------------------------------------------------------- | ---------- | -------------- | ------------------- | -------------- | -------------- |
| Системные требования                                                    | ОС Windows 7, 4GB RAM, 4 GB на диске | ? | ОС Windows 7, 2GB RAM, 1 GB на диске | ОС Windows 7 | ОС Windows 7, 8GB RAM, 1 GB на диске |
| Возможность экспорта отчета в форматы популярных табличных процессоров  |     -      |        +       |          +          |        +       |       +        |
| Поддержка чтения данных посредством промышленных протоколов OPC и Modbus|     +      |        +       |          -          |        -       |   только OPC   |
| Возможность просмотра отчетов через Web-интерфейс                       |     +      |        -       |          +          |        -       |       +        |
 


В ходе обзора аналогов было установлено, что большая часть решений ориентирована на работу 
в операционных системах семейства Windows.
По итогам сравнения можно сделать вывод, что большинство рассмотренных решений предоставляет
 возможность экспорта отчетов в форматы популярных табличных процессоров, что позволяет
выполнять ручное редактирование данных в отчете после его построения, а также оформление отчета
 без необходимости его перестраивать.
Также следует отметить, что большинство из рассмотренных решений позволяет просматривать отчеты 
через Web-интерфейс, благодаря чему не требуется установка и настройка дополнительного ПО на 
устройствах
для просмотра отчетов.

В ходе обзора существующих программных решений были отмечены следующие их недостатки:
- отсутствие возможности чтения данных по промышленным протоколам OPC и Modbus, в результате чего требуется использование дополнительного ПО для чтения и хранения данных.
- отсутствие возможности просмотра отчетов через веб-интерфейс, что уменьшает перечень устройств для просмотра отчетов.

Также в ходе обзора было выявлено, что большинство решений поддерживают экспорт в формат для популярных табличных процессоров, что позволяет редактировать уже построенные отчеты.

## Выбор метода решения
Программное решение должно иметь клиент-серверную архитектуру. 
Построение отчетов должно производиться на сервере, благодаря чему настройку подключения ко внешним
источникам данных потребуется производить только для сервера. Просмотр, редактирование, а также управление
параметрами построения отчета должно производиться посредством веб-интерфейса. Таким образом, данная 
архитектура упростит развертывание приложения.

Решение должно соответствовать следующим характеристикам:
- Разработанное приложение должно работать на системе с 4 GB ОЗУ под управлением OC семейства Windows. 
- Должна быть предусмотрена возможность экспорта построенного отчета в формат Excel.
- Требуется поддержка чтения данных по протоколам Modbus и OPC.
- Необходимо наличие Web-интерфейса для просмотра отчетов, в том числе и с мобильных устройств.
- Решение должно строить отчеты в условиях ограниченных ресурсов за приемлемое время.

## Заключение
В ходе данного исследования была достигнута поставленная цель. А именно, были сформированы
требования к программному решению проблемы автоматизации построения отчетов и методы решения поставленной
проблемы. Для формирования требований предварительно был сделан обзор существующих решений, в ходе
которого были выявлены недостатки существующих решений. Направления для дальнейших исследований
включают в себя разработку системы контроля версий отчетов.



