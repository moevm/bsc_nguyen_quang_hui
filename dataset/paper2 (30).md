# Разработка имитационной платформы SOA-приложений для автоматизированного тестирования приложения обработки заказов клиентов

Ключевые слова: SOA-система, интеграционное тестирование, Jenkins.

## Аннотация

В данной статье рассмотрены причины необходимости создания имитационной платформы SOA-систем для тестирования приложения обработки заказов клиентов, выполнен анализ существующих решений для автоматизированного тестирования. При сравнительном анализе были выявлены их недостатки, которые были учтены при формировании функциональных требований к разрабатываемому приложению. Предложено направление для дальнейших исследований. 

## Введение

Тестирование программного обеспечения является одним из основных методов управления качеством. При наличии нескольких SOA-систем, которые взаимодействуют с основным приложением, используя внутренний протокол SOA BP(Service-Oriented Architecture Backplane), возникает потребность в автоматизированном интеграционном тестировании. Наличие платформы, которая способна имитировать SOA-системы, дает возможность внедрять автоматизированное интеграционное тестирование.  
Количество систем, взаимодействующих с приложением, увеличивается, поэтому целью данной работы является создание имитационной платформы SOA-приложений для автоматизированного интеграционного тестирования приложения для обработки заказов клиентов, которая сможет имитировать все партнерские системы при обмене данными с этим приложением.
Проблема заключается в разработке унифицированного, масшабируемого алгоритма для имитации SOA-приложений, которые обмениваются данными с основным приложением посредством внутреннего протокола SOA BP.

Для достижения поставленной цели требуется решить следующие задачи:

1. Рассмотреть аналоги систем автоматизированного тестирования.
2. Определить требования для архитектуры системы, обеспечивающую передачу данных по протоколу SOA BP.
3. Разработать метод коммуникации сервера приложения обработки заказов и разрабатываемой имитационной платформой, при котором разрабатываемая платформа будет способна отвечать на запросы сервера в автоматическом режиме.
4. Разработать план внедрения имитационной платформы SOA-приложений в автоматизированное интеграционное тестирование системы обработки заказов клиентов.

## Обзор предметной области

### Принцип отбора аналогов

Отбор аналогов производился согласно функциональным требованиям к системе автоматизированного тестирования. В табл. 1 приведено сравнение существующих систем тестирования. 

**SoapUI** - кроссплатформенное приложение, которое используется при тестировании приложений, которые обмениваются данными по протоколу SOA. Данная система позволяет наладить автоматизированное тестирование приложений, а также может быть использовано системами непрерыной интеграции, например, Jenkins. Также приложение позволяет менять начальные свойства в режиме исполнения.[1] 

**Wizdler** - легковесный инструмент для тестирования приложений, который поддерживает только SOA архитектуру. Данный инструмент является кроссплатформенным, однако не может быть использован в системе непрервыной интеграции. Платформа не позволяет изменять начальные свойства тестируемого приложения без перезагрузки сервера. Система доступна на платформах Windows и Linux.[2]

**UFT(Unified Functional Testing)** - приложение, предназначенное для автоматизации функциональных и регрессионных тестов. С помощью UFT возможно тестирование широкого спектра приложений, в том числе и SOA-приложений. Также UFT может работать с такими интеграционными программами, как Jenkins. UFT доступно только на Windows и не позволяет изменять изначально заданные свойства тестируемого приложения.[3]

**TestComplete** - инструмент для тестирования мобильных и веб-приложений. Обеспечивает тестирование SOA-приложений, также совместим с Jenkins в течение процесса непрерывной интеграции. TestComplete доступен только на Windows. Данная система не предоставляет возможность изменять начальные свойства приложения.[4]

**SimDMS** - система, предназначенная для тестирования приложения обработки заказов и стороннего сервиса, который взаимодействует с приложением по протоколу SOA BP. SimDMS может быть использован с системами непрерывной интеграции. Доступен только на Windows. SimDMS предоставляет интерфейс, с помощью которого могут быть изменены начальные свойства приложения.[5]

В качестве **критериев сравнения** были выбраны:

1. **Кроссплатформенность** - позволяет увеличить количество пользователей системой. Аналоги оценены по трехбалльной шкале: 1 - программа доступна на одной платформе (Windows, Linux или Mac OS), 2 - программа доступна на двух платформах, 3 - программа доступна на трех основных платформах(Windows, Linux и Mac OS).
2. **Работа с системами непрерывной интеграции** - позволяет автоматизировать часть процесса разработки и тестирования программного обеспечения
3. **Поддержка расширенного протокола SOA** - возможность тестировать приложения, которые обмениваются данными по расширенному протоколу SOA - SOA BP. Данный протокол был разработан компанией Deutche Telekom и не является общедоступным.
4. **Изменение начальных свойств без перезагрузки сервера** - способность менять начальные свойства приложения в режиме исполнения.

Таблица 1 - Сравнение аналогов

|                                                     | SoapUI            |              Wizdler              |                 UFT                   | TestComplete       | SimDMS             |
| --------------------------------------------------- | ----------------- | ----------------------------------| --------------------------------------| ------------------ | ------------------ |
| Кроссплатформенность                                |            3      |       2(Windows и Linux)          |                   1(Только Windows)   |  1(Только Windows) | 1(Только Windows)  |
| Работа с системами непрерывной интеграции           |            Да     |                  Нет              |                  Да                   |          Да        | Да                 |
| Поддержка расширенного протокола SOA                |            Нет    |                  Нет              |                  Нет                  |          Нет       | Да                 |
| Изменение начальных свойств без перезагрузки сервера|            Да     |                  Нет              |                  Нет                  |          Нет       | Да                 |

### Выводы по итогам сравнения

SoapUI, UFT, TestComplete и SimDMS могут быть использованы в системе непрерывной интеграции, что позволяет автоматизировать процесс тестирования SOA приложений. Однако, UFT, TestComplete  и SimDMS не являются клоссплатформенными, Wizdler - кроссплатформенное приложение, но оно не поддерживает интеграцию с Jenkins.

Поскольку тестируемое приложение обменивается данными по расширенному протоколу SOA BP, то существует необходимость в поддержке этого протокола системой, которая будет использоваться для тестирования.

SimDMS обладает многофункциональным интерфейсом, с помощью которого возможно обмениваться данными по протоколу SOA BP, а также изменять настройки тестируемого приложение, однако данная система подходит для тестирования только одного партнерского приложения. 

Рассмотренные аналоги не позволяют создать кроссплатформенное решение для тестирование партнерских приложений. Поэтому, необходимо разработать платформу, которая смогла бы имитировать системы, которые используют протокол SOA BP. Это позволит автоматизировать процесс тестирования основного приложения.

## Выбор метода решения

В ходе обзора главным недостатком аналогов стало отстутствие поддержки протокола SOA BP. В результате были сформированы требования для нового программного решения.

Решение должно представлять собой серверное приложение, которое взаимодействует с основным приложением по протоколу SOA BP.

Решение должно обладать следующими качествами:

1. Приложение должно функционировать на операционных системах Windows и AIX.
2. Решение должно работать в системе непрерывной интеграции Jenkins.
3. Платформа должна позволят менять начальные свойства приложения в режиме исполнения

## Описание метода решения

Для обеспечения обмена данных по протоколу SOA BP, решение должно соответствовать следующим архитектурным требованиям:

1. Проектируемая SOA-система использует SOAP веб-службы для обмена данных с основным приложением.
2. При обмене данных используется библиотека JAXB(Java Architecture for XML Binding)[6], которая позволяет преобразовывать представление объектов в памяти в формат данных XML и наоборот.
3. Приложение должно обладать двумя компонентами конфигурации: основной и текущей. Основная конфигурация не может быть изменена без презагрузки приложения. Основная конфигурация включает в себя такие параметры, как путь к конечной точке, хост и порт SOA-системы. Текущая конфигурация включает в себя текущий режим системы, код ошибки для ответов об ошибках, значение задержки для ответов. Параметры текущей конфигурации могут быть изменены без перезагрузки сервера приложения посредством отдельной SOAP веб-службы.
4. Проектируемая система является масштабируемой. Т.е. при появлении новой SOA-системы, которую необходимо имитировать, в программе создается новая SOAP веб-служба без изменений других компонентов.

Основные компоненты проектируемой системы представлены на рис.1.

<figure>
   <p><img src="./pics/1.jpg" align="middle"></p>
   <figcaption> Рисунок 1. Основные компоненты проектируемой системы</figcaption>
 </figure>
</body>


Проектируемая система использует SOAP веб-службы, которые могут отвечать на запросы сервера, основного приложения, в автоматическом режиме, в том числе синхронно и асинхронно.[7] Для обмена данными между основным приложением и проектируемой системой в базе данных основного приложения необходимо создать параметр в одной из конфигурационных таблиц с указанием адреса имитационной платформы, чтобы была возможность формировать запросы к этой платформе напрямую.
Для генерации ответа для основного приложения в проектируемой SOA-системе существуют два режима работы:
- режим, в котором ответ системы генерируется на основе данных запроса.
- режим, в котором система использует полностью предустановленный ответ, который не зависит от поступившего запроса. Данный ответ настраивается с помощью параметров текущей конфигурации и может быть изменен без перезагрузки приложения.
В обоих случаях ответ будет посылаться с задержкой, которая является изменяемым параметром текущей конфигурации.

Для использования платформы в автоматизированном интеграционном интеграционном тестировании необходимо разработать план внедрения приложения в процесс тестирования.

###  План внедрения имитационной платформы SOA-приложений в автоматизированное интеграционное тестирование системы обработки заказов клиентов

Данный план предполагает, что исследуемая платформа разработана и протестирована. Для автоматизированного тестирования используется система непрерывной интеграции Jenkins. Для интеграции разработанной системы с Jenkins должны быть выполнены следующие требования:

1. Приложение поставляется как единый исполняемый JAR-файл.
2. Спроектированы и реализованы интеграционные тесты, которые используют реализованную платформу.
3. Настроено окружение, на котором будет установлен Jenkins.
4. Написаны Jenkins-задачи для сборки, запуска, перезагрузки и изменения настроек разработанной системы.

Представляет интерес для дальнейшего исследования вопрос поддержки протокола SSL, который может быть использован для имитации защищенного обмена данных между основным приложением и партнерскими SOA-системами.

## Заключение

В рамках данного исследования проведен сравнительный анализ существующих систем автоматизированного тестирования по следующим критериям: кроссплатформенность, возможность работы с системами непрерывной интеграции, поддержка расширенного протокола SOA и возможность изменения начальных свойств без перезагрузки сервера. 

По результатам сравнения сделан вывод:

- О недостатках рассмотренных решений (у рассмотренных кроссплатформенных систем нет возможности обмениваться данными по протоколу SOA BP)
- О необходимости разработки новой платформы, которая способна имитировать несколько партнерских SOA-систем. 

Выделены архитектурные требования, основа которых - использование SOAP веб-служб при обмене данными с основным приложением, а также наличие текущей конфигурации, которая может быть изменена без перезагрузки приложения.

Разработаны два режима работы системы, при которых SOAP веб-службы отвечают на запросы основного приложения в автоматическом режиме.

Составлен план внедрения SOA-системы в процесс автоматизированного интеграционного тестирования, где предполагается использовать разработанное приложение совместно со средой непрерывной интеграции Jenkins.

Следует заметить, что особый интерес для дальнейшего исследования представляет вопрос поддержки протокола SSL, который может быть использован для имитации защищенного обмена данных между основным приложением и партнерскими SOA-системами.

## Список литературы
1. Soap UI Documentation [Электронный ресурс]. URL: https://www.soapui.org/soapui-projects/soapui-projects.html
2. Medium [Электронный ресурс]. URL: https://medium.com/@briananderson2209/best-automation-testing-tools-for-2018-top-10-reviews-8a4a19f664d2
3. Microfocus [Электронный ресурс]. https://www.microfocus.com/en-us/products/uft-one/overview#block2
4. TestComplete Documentation [Электронный ресурс]. URL: https://support.smartbear.com/testcomplete/docs/
5. Kuzmenkov N. (2018) SimDMS concept.
6. JAXB Users Guide [Электронный ресурс]. URL: https://javaee.github.io/jaxb-v2/doc/user-guide/
7. Snell J., Tidwell D., Kulchenko P. (2001) Programming Web Services with SOAP.
