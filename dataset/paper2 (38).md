# Сравнительный анализ инструментов OCR, используемых при разработке Android-приложений
Ключевые слова: инструмент оптического распознавания символов, Android-приложение, Android-разработка, библиотека OCR, прикладной
программный интерфейс (API).

## Аннотация
Целью данной работы является исследование и сравнительный анализ инструментов оптического распознавания символов (OCR), используемых
при разработке Android-приложений. В данной статье представлена информация о наиболее используемых в Android-разработке инструментах OCR.
Выявлены их преимущества и недостатки, а также факторы, влияющие на выбор инструмента OCR в зависимости от требований к разрабатываемому
Android-приложению. Даны рекомендации по выбору наиболее подходящего существующего решения. 
## Введение
В настоящее время возникает все больше моделей телефонов и планшетов на базе Android, а значит спрос на Android-приложения растет. 
Зачастую в таких приложениях возникает необходимость распознавания текстовых данных с изображений, а также в процессе видеосъемки. 
Выбрать подходящий под конкретную задачу инструмент для оптического распознавания символов не так просто, как может показаться на первый
взгляд. Разработчики могут сделать неправильный выбор и создать приложение, не удовлетворяющее требованиям заказчика: тсутствие поддержки нужного языка, большой объем занимаемой памяти и тд. Время и трудовые ресурсы разработчиков будут использованы 
зря. Поэтому при разработке Android-приложений важно выбрать наиболее подходящее существующее решение оптического распознавания символов.
Данная статья поможет разработчику не ошибиться в выборе инструмента OCR. Цель статьи – исследование и сравнительный анализ
инструментов OCR, формирование рекомендаций по выбору наиболее подходящего существующего решения. Объекты исследования – инструменты
оптического распознавания символов. Предмет исследования – сравнение характеристик этих инструментов. Для достижения поставленной 
цели необходимо структурировать информацию о наиболее используемых в Android-разработке инструментах OCR, выявить их преимущества и недостатки, обозначить факторы, влияющие на выбор инструмента OCR.
## Обзор предметной области.
В настоящее время различные производители программного обеспечения предоставляют свои инструменты оптического распознавания 
символов. Был произведен обзор инструментов OCR, используемых при Android-разработке. Для обзора были выбраны инструменты OCR от Google,
Yandex, Microsoft Azure, ABBYY.
1.	**Tesseract OCR**[1] – библиотека OCR от Google, написанная на языках C и C++. Использует нейронные сети для поиска шаблонов букв и
слов в пикселях. Для распознавания требуется два прохода по данным. Во время первого происходит распознавание известных символов, 
а во время второго - заполнение оставшихся символов, исходя из контекста. Библиотека поддерживает 123 языка, в том числе русский. 
Является бесплатной, а также имеет открытый исходный код, что позволяет изменять ее файлы и добавлять свои файлы, необходимые для проекта. Из-за большого количества файлов, библиотека занимает сравнительно большой объем памяти, поэтому, если приложение
должно работать в режиме offline, оно будет занимать много памяти устройства. Эту проблему можно решить разместив обработку изображений на сервере. По времени обработки текста изображения Tesseract не занимает
лидирующей позиции среди инструментов OCR.
2.	**Mobile Vision Text Api** [2] – прикладной программный интерфейс от
Google для распознавания текста на изображениях и в видеопотоках. Написано специально для мобильных устройств. Использует машинное обучение для мобильных разработчиков, является частью ML Kit[3].
API-интерфейсы ML Kit позволяют осуществить визуальный поиск и извлечение текста. Распознаватель текста разделяет текст на блоки, 
строки и слова. Блок представляет собой непрерывный набор текстовых строк, например, абзац или столбец. Строка представляет собой 
непрерывный набор слов на одной и той же вертикальной оси. Слово представляет собой непрерывный набор алфавитно-цифровых символов
на одной вертикальной оси. Mobile Vision Text Api с высокой точностью распознает текст на языках с латинскими буквами в режиме 
реального времени на устройстве. Не требует большого объема памяти. Однако русский текст данным инструментом OCR распознать не удастся.
При сборке приложения требуется доступ к сети Интернет,  но собранное приложение сможет распознавать текст в режиме offline.  
3.	**Google Cloud’s Vision API**[4] – прикладной программный интерфейс от Google. Облачное API распознавания не увеличивает размер
приложения, его можно Применять для различных вариантов использования. Например, включить функциональность распознавания в приложение, в котором она
не является основной. API предлагает предварительно обученные модели машинного обучения через REST и RPC API. Использует OCR для
обнаружения текста в изображениях на более чем 50 языках. Применимо к различным типам файлов, а также осуществляет чтение печатного и рукописного текста.
Есть возможность массовой обработки документов и документов AI, которая позволяет быстро обрабатывать несколько документов и
автоматизировать бизнес-процессы. Также можно назначать метки изображениям и быстро классифицировать их. Для большей точности
распознавания изображений в API Cloud Vision, изображения должно иметь разрешение не менее 640 x 480 пикселей. Файлы изображений, отправляемые
в Cloud Vision API, не должны превышать 20 МБ, а размер запроса JSON - 10 МБ. Данный инструмент OCR является платным.
4.	**Распознавание текста (Optical Character Recognition, OCR) в сервисе Yandex Vision**[5]. Текст на изображении распознается в два
этапа. Первый этап - обнаружение языковой модели для распознавания текста. Сервис обеспечивает распознавание текста на основе модели, 
которая обучается на определенном наборе языков. Некоторые языки сильно отличаются друг от друга (например, арабский и китайский), поэтому
они используют три разные модели: англо-русскую, латино-кириллическую (поддерживает языки с латинской 
и кириллической письменностью), а также прочие модели (один основной язык и русский с английским). Второй этап распознавания - обнаружение
текста на изображении. Сервис выделяет текстовые символы, найденные на изображении, и группирует их по уровням: слова группируются
в строки, строки - в блоки, а блоки - в страницы. В результате распознавания сервис вернет JSON-объект с распознанным текстом, его
расположением на странице и достоверностью распознавания. Может распознавать текст с одного изображения, размер которого не
превышает 20 мегапикселей.
Поддерживаемые форматы файлов: JPEG, PNG, PDF. Максимальный размер файла: 1 МБ. Сервис является платным.
5.	**Computer Vision API OCR**[6] от Microsoft Azure. Распознавание текста основано на машинном обучении. Поддерживает 25 языков,
в том числе русский. Можно распознавать как печатный, так и рукописный текст. При необходимости OCR исправляет поворот в градусах 
распознанного текста с помощью смещения относительно горизонтальной оси изображения. Может распознавать текст с изображения, размер
которого от 50 x 50 до 4200 x 4200 пикселей. Поддерживаемые форматы файлов: JPEG, PNG, GIF,BMP.  Возможность распознавания только с доступом к сети Интернет. Продукт платный.
6.	**ABBYY Cloud OCR SDK**[7]. API является облачным, поэтому не увеличивает размер приложения, использует REST API. Алгоритмы 
основаны на базе искусственного интеллекта, машинного обучения и адаптивной технологии распознавания документов 
Adaptive Document Recognition Technology[8]. На этапе анализа документа программа разбивает его на отдельные страницы и проверяет
оформление каждой из них, выявляет расположение текста, изображений, элементов таблиц. Параллельно проверяется логическая структура 
документа. Размер файла должен быть не более 30 МБ. Максимальный размер изображения составляет 32512×32512 пикселей. Поддерживает
распознавание печатного и рукописного текста. Распознает 63 языка, в том числе русский. Продукт платный.
### Критерии сравнения.
Так как целью было исследование и сравнительный анализ инструментов OCR, были выделены следующие факторы, являющиеся критериями
сравнения, на которые следует опираться при выборе инструмента OCR при разработке Android-приложения. В скобках будут указаны условные обозначения, для сравнительной таблицы 1, представленной ниже.
1.	Количество распознаваемых языков. Критерий важен при создании мультиязыкового приложения. 
2.	Распознавание русского языка. ( "+" – распознает,  "-" – не распознает).
3.	Распознавание рукописного текста. ( "+" – распознает,  "-" – не распознает).
4.	Открытый исходный код. Дает возможность модифицировать файлы инструмента OCR. Важный критерий, если в процессе разработки
необходимо изменять файлы инструмента OCR и добавлять в него собственные файлы. ( "+" – открытый,  "-" – не открытый).
5.	Необходимость доступа к сети. Критерий стоит учитывать при возможной необходимости использования приложения в режиме offline. (требуется ли доступ к сети Интернет: "+" – требуется, "-" – не требуется)
6.	Увеличение размера приложения инструментом OCR. Важный критерий, если в требованиях к разрабатываемому приложению стоит
ограничение на объем занимаемой памяти либо функциональность распознавания текста не является основной. (Как увеличивает данный 
инструмент OCR размер разрабатываемого приложения: существенно, не существенно, не увеличивает).
7.	Возможность обрабатывать одноврнеменно несколько изображений. Важный критерий, если требуется распознавать несколько изображений за раз,
а также автоматизировать процесс обработки. В случае обработки нескольких изображений важен максимальный размер обрабатываемого объекта.  (Можно ли обработать несколько изображений сразу: если нельзя, то "-", если можно,
то максимальный размер объекта).
8.	Верхняя граница стоимости обработки одного изображения. Важный критерий, если бюджет разработчика ограничен.

Результаты сравнения инструментов OCR по критериям представлены в таблице 1.

Таблица 1.
  
  | Инструмент OCR |   1  |     2   | 3    | 4  |  5  | 6   | 7   | 8  |
| ---------------- | ---- | ------- | ---- | --- | ---- | ---- | ---- | ---- |
| Tesseract OCR         | 123 | + | -    | +  | - | существенное | - | 0 |
| Mobile Vision Text Api       | 18 | - | - | - | - | не существенное | - | 0 |
| Google Cloud’s Vision API | 50 | + | + | - | + | не увеличивает | 20Mb | 1,5$ |                      
| Yandex Vision | 43 | + | - | - | + | не существенное | - | 0,12 руб |
| Computer Vision API OCR |	25    |	+   |	+	  | -	  | +	  | не существенное	 | -	 |  62,5 руб |   
| ABBYY Cloud OCR SDK	  | 63    |  +	| +	  | -	  | + 	| не увеличивает	 | 30Mb	 | 0,06$   |


В результате сравнения было выявлено, что больше всего языков может распознавать бесплатная библиотека Tesseract OCR.
Также она имеет открытый исходный код и для ее работы не требуется подключение к сети Интернет. Однако ее использование увеличивает 
размер приложения.

Mobile Vision Text API считывает только печатный текст языков с латинским алфавитом, является бесплатным, не загружает память и
предоставляет возможности распознавать текст в режиме реального времени. Разработанное приложение сможет распознавать текст в режиме
offline.

Yandex Vision способен распознавать русский печатный текст с изображения, его работа не загружает память. Имеет небольшую стоимость 
относительно платных аналогов.

Рукописный текст считывают инструменты OCR: Google Cloud’s Vision API, Computer Vision API OCR и ABBYY Cloud OCR SDK. 
Однако Computer Vision API OCR не может обрабатывать сразу несколько изображений.

Google Cloud’s Vision API и ABBYY Cloud OCR SDK являются облачными, поэтому не увеличивают размер приложения, ABBYY Cloud OCR SDK
распознает большее количество языков и способно обрабатывать файл изображений большего размера, чем Google Cloud’s Vision API.

## Выводы
В результате обзора инструментов оптического распознавания символов, был произведен анализ и сравнение инструментов OCR различных
производителей по выявленным критериям.
На основе результатов сравнения можно сформировать следующие рекомендации выбора наиболее подходящего существующего
решения. 

1.  В случае разработки Android-приложения, нацеленного на считывание печатного текса.

1.1.  Если разработчику нужно распознавать текст языка с латинским алфавитом, то следует использовать Mobile Vision Text API.
Интерфейс является бесплатным, считывает достоверно и не загружает память, а также предоставляет возможность распознавать текст
в процессе видеосъемки в режиме реального времени. Приложение сможет работать без доступа к сети Интернет.

1.2.	Если в приложении требуется считывать русский печатный текст с изображения, при этом денежные ресурсы разработчика ограничены,
то следует выбрать сервис Yandex Vision API.

2.	В случае разработки Android-приложения, нацеленного и на печатный, и на рукописный текст, можно использовать
Google Cloud’s Vision API, Computer Vision API OCR или ABBYY Cloud OCR SDK. 

2.1.	Если требуется обрабатывать сразу несколько изображений, то следует выбрать Google Cloud’s Vision API или ABBYY Cloud OCR SDK.

2.1.1.	При  необходимости распознавания не только текста, но и других реальных объектов следует выбрать Google Cloud’s Vision API, 
так как его можно использовать для распознавания этих объектов.

2.1.2.	Если приложение распознает только текст, следует использовать ABBYY Cloud OCR SDK, он распознает большее количество языков,
может обрабатывать файлы большего размера, а также яляется более бюджетным вариантом.

3.  Если размер разрабатываемого Android-приложение должен быть минимальным, то следует выбрать облачные инструменты OCR - 
Google Cloud’s Vision API или ABBYY Cloud OCR SDK. Выбрать один из этих инструментов можно  соответствии с пунктами 2.1.1 и 2.1.2

4.  Если разработчик в своем приложении должен распознавать неизвестный инструментам OCR язык, либо должен как-то 
модифицировать систему распознавания, то он может использовать библиотеку Tesseract OCR. Она имеет открытый исходный код 
и для ее работы не требуется подключение к сети Интернет.

5.  Бесплатными инструментами OCR являются Tesseract OCR и Mobile Vision Text API. 

## Заключение

В рамках данной работы были исследованы инструменты оптического распознавания символов, используемые при разработке Android-приложений, от компаний Google, Yandex, Microsoft Azure, ABBYY.
Выявлены факторы выбора того или иного инструмента: поддержка различных языков распознавания, возможность распознавать рукописный текст,
возможность работать без доступа к сети Интернет, одновременное распознавание нескольких изображений,стоимость инструмента OCR, 
возможность модифицировать исходный код, а также объем занимаемой памяти. На основе выявленных факторов был произведен сравнительный
анализ инструментов OCR и сформированы рекомендации для выбора наиболее подходящего существующего решения. Результаты работы
могут быть использованы при разработке Android-приложений, функциональность которых предполагает возможность оптического распознавания символов.

## Источники
1.	tesseract Documentation [Электронный ресурс]. Дата обновления: 21.05.2017.
URL: https://github.com/tesseract-ocr/tesseract/wiki/Documentation (дата обращения: 03.12.2019).
2.	Text Recognition API Overview [Электронный ресурс]. URL: https://developers.google.com/vision/android/text-overview 
(дата обращения: 03.12.2019).
3.	ML Kit [Электронный ресурс]. https://developers.google.com/ml-kit (дата обращения: 03.12.2019).
4.	Vision AI [Электронный ресурс]. URL: https://cloud.google.com/vision/ (дата обращения: 03.12.2019).
5.	Yandex Vision [Электронный ресурс]. URL: https://cloud.yandex.ru/docs/vision/ (дата обращения: 03.12.2019).
6.	Computer Vision [Электронный ресурс]. URL: https://azure.microsoft.com/ru-ru/services/cognitive-services/computer-vision/ 
(дата обращения: 03.12.2019).
7.	ABBYY Cloud OCR SDK [Электронный ресурс]. URL: https://www.ocrsdk.com (дата обращения: 03.12.2019).
8.	ADRT [Электронный ресурс]. URL: https://abbyy.technology/en:features:ocr:adrt (дата обращения: 03.12.2019).
